<!DOCTYPE html> 
<html> 
	<head> 
		<title> 
		MCS Mini Project 
		</title> 
	</head> 
	<body>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous"> 
        <div class="alert alert-primary" role="alert">
            <h1 align="center" style="font-family:montserrat;">MCS(Mobile Communication Systems) Mini Project </h1>
        </div>
        <h2 align="center" id="progress" style="font-family:montserrat;color:white;">Click on "Check the internet Connection" to start.</h2>
        <h1 align="center">
        <button onclick="InitiateSpeedDetection()" type="button" style="font-family:montserrat;" class="btn btn-outline-warning btn-lg">Check the internet Connection</button></h1>
		
        <h2  align="center" id="status" style="font-family:montserrat;color:white;">I'm not sure!</h2>
        <br><br><br>
        <div  class="card text-white bg-warning mb-3" style="margin-left:auto;margin-right:auto;max-width: 60%;">
  <div class="card-header" style="font-family:montserrat;">Note:</div>
  <div class="card-body">
    <p class="card-title" style="font-family:montserrat;">In case if this program doesn't work. Please enable your JavaScript.</p>
  </div>
  </div>
  <br><br><br><br><br><br>
  <h3 class="text-center" style="color:white;font-family:montserrat;">Made with ‚ù§ by Nilesh Ohol.</h3>
        <style>
        body{
            background-color:#1C1C1C;
        }
        </style>
        <script>
        //JUST AN EXAMPLE, PLEASE USE YOUR OWN PICTURE!
        var imageAddr = "https://images.pexels.com/photos/5589858/pexels-photo-5589858.jpeg";
        var downloadSize = 11522637; //bytes
        const status = document.getElementById("status")

        function ShowProgressMessage(msg) {
            if (console) {
                if (typeof msg == "string") {
                    console.log(msg);
                } else {
                    for (var i = 0; i < msg.length; i++) {
                        console.log(msg[i]);
                    }
                }
            }
            
        var oProgress = document.getElementById("progress");
            if (oProgress) {
                var actualHTML = (typeof msg == "string") ? msg : msg.join("<br />");
                oProgress.innerHTML = actualHTML;
            }
        }

        function InitiateSpeedDetection() {
            ShowProgressMessage("We are having a look at your Internet Speed, please wait...");
            window.setTimeout(MeasureConnectionSpeed, 1);
        };    

        function MeasureConnectionSpeed() {
            var startTime, endTime;
            var download = new Image();
            download.onload = function () {
                endTime = (new Date()).getTime();
                showResults();
            }
            
            download.onerror = function (err, msg) {
                ShowProgressMessage("Invalid image, or error downloading");
            }
            
            startTime = (new Date()).getTime();
            var cacheBuster = "?nnn=" + startTime;
            download.src = imageAddr + cacheBuster;
            
            function showResults() {
                var duration = (endTime - startTime) / 1000;
                var bitsLoaded = downloadSize * 8;
                var speedBps = (bitsLoaded / duration).toFixed(2);
                var speedKbps = (speedBps / 1024).toFixed(2);
                var speedMbps = (speedKbps / 1024).toFixed(2);
                var speedmsg = "Your Internet connection is good"
                if(speedMbps < 10){
                    var speedmsg = "Your internet connection needs improvement"

                }
                ShowProgressMessage([
                    "Your current connection speed is: <br>", 
                    speedBps + " bps (bytes per second)", 
                    speedKbps + " kbps (kilobytes per second)", 
                    speedMbps + " Mbps (Megabytes per second)",
                    "<br> Note: " + speedmsg
                    
                ]);
            }
        }
        if(navigator.onLine){
            status.textContent = "We are online";
            status.style.color = "green";
        }
        
        window.addEventListener('online',function(){
        status.textContent = "We are online";
        status.style.color =  "darkgreen";
        });
        window.addEventListener('offline',function(){
        status.textContent = "We are offline";
        status.style.color =  "red";
        });
        


        </script>
        

        <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.min.js" integrity="sha384-w1Q4orYjBQndcko6MimVbzY0tgp4pWB4lZ7lr30WKz0vr/aWKhXdBNmNb5D92v7s" crossorigin="anonymous"></script>
	</body> 
</html> 
